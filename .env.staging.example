# ===========================================
# CritGenius Listener - Staging Environment Configuration
# ===========================================
# Copy this file to .env.staging for staging deployment
# This configuration balances development flexibility with production-like security

# Node.js Environment
NODE_ENV=staging
PORT=3100
CLIENT_PORT=3101
HOST=0.0.0.0

# AssemblyAI Configuration
# Production API key required - get from: https://www.assemblyai.com/
ASSEMBLYAI_API_KEY=your_production_assemblyai_api_key_here
ASSEMBLYAI_WEBHOOK_URL=https://staging.critgenius-listener.com/api/webhooks/assemblyai

# Database Configuration (Staging Environment)
MONGODB_URI=mongodb+srv://username:password@staging-cluster.mongodb.net/critgenius-listener?retryWrites=true&w=majority
MONGODB_DB_NAME=critgenius-listener
REDIS_URL=rediss://username:password@staging-redis.cloud.redislabs.com:6379
REDIS_PASSWORD=your_redis_password_here
REDIS_DB=0

# CritGenius Ecosystem URLs (Staging)
CRITGENIUS_ECOSYSTEM_BASE_URL=https://staging-ecosystem.critgenius.com
CRITGENIUS_PROMPTER_URL=https://staging-prompter.critgenius.com
CRITGENIUS_LLM_URL=https://staging-llm.critgenius.com
CRITGENIUS_PUBLISHER_URL=https://staging-publisher.critgenius.com
CRITGENIUS_ECOSYSTEM_API_KEY=staging_ecosystem_api_key_here
CRITGENIUS_SERVICE_TOKEN=staging_service_token_here

# Security Configuration (Staging - Enhanced)
JWT_SECRET=staging_jwt_secret_minimum_32_characters_required_change_this
JWT_EXPIRES_IN=7d
CORS_ORIGINS=https://staging.critgenius-listener.com,https://staging-client.critgenius.com
CSP_ENABLED=true
HELMET_ENABLED=true
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Audio Processing Configuration
MAX_AUDIO_FILE_SIZE=52428800
MAX_AUDIO_DURATION=3600
SUPPORTED_AUDIO_FORMATS=wav,mp3,m4a,flac,ogg

# Session Configuration
SESSION_TIMEOUT=60
MAX_CONCURRENT_SESSIONS=25

# Export Configuration
EXPORT_TEMP_DIR=/tmp/critgenius-exports
EXPORT_MAX_SIZE=104857600

# Data Retention Configuration
AUTO_CLEANUP_ENABLED=true
CLEANUP_INTERVAL_HOURS=24
DEFAULT_RETENTION_DAYS=14

# Privacy Configuration (Production-like)
GDPR_ENABLED=true
DATA_ANONYMIZATION_ENABLED=true
CONSENT_REQUIRED=true

# Logging Configuration (Structured for Staging)
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_PATH=/var/log/critgenius-listener/app.log

# Performance Configuration
WS_HEARTBEAT_INTERVAL=30000
WS_MAX_CONNECTIONS=100
CACHE_TTL=300
CACHE_MAX_SIZE=1000

# Monitoring Configuration (Enhanced)
HEALTH_CHECK_ENABLED=true
METRICS_ENABLED=true
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/staging/webhook/url
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/staging/webhook/url

# Development Configuration (Limited)
DEBUG=critgenius:error,critgenius:warn
DEBUG_SQL=false
DEBUG_REDIS=false
HOT_RELOAD=false
WATCH_FILES=false

# Testing Configuration
TEST_MONGODB_URI=mongodb+srv://username:password@staging-cluster.mongodb.net/critgenius-listener-test?retryWrites=true&w=majority
TEST_REDIS_URL=rediss://username:password@staging-redis.cloud.redislabs.com:6380
MOCK_ASSEMBLYAI=false
MOCK_ECOSYSTEM_SERVICES=false

# Production Configuration (Staging SSL)
SSL_ENABLED=true
SSL_CERT_PATH=/etc/ssl/certs/staging.critgenius-listener.com.crt
SSL_KEY_PATH=/etc/ssl/private/staging.critgenius-listener.com.key
CSP_REPORT_URI=/api/csp-report

# ===========================================
# Staging Environment Notes
# ===========================================
# This configuration is optimized for:
# - Production-like security with staging flexibility
# - Structured logging for monitoring
# - SSL/TLS encryption required
# - Enhanced monitoring and alerting
# - Privacy compliance testing
# - Performance monitoring

# Staging Requirements:
# 1. SSL certificates must be properly configured
# 2. Database connections must use SSL/TLS
# 3. All API keys must be production-grade
# 4. Monitoring webhooks should be configured
# 5. CORS origins must match staging domains

# Security Notice:
# This configuration uses production-grade security
# All secrets must be properly secured and rotated regularly
# SSL/TLS is required for all external connections

# Deployment Checklist:
# □ SSL certificates installed and valid
# □ Database connections secured with SSL
# □ All API keys are production-grade
# □ Monitoring webhooks configured
# □ CORS origins match staging domains
# □ JWT secret is 32+ characters
# □ All passwords are strong and unique
