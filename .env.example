# CritGenius Listener â€“ Example Environment Variables

# Core
NODE_ENV=development
HOST=localhost
PORT=3100
CLIENT_PORT=5173

# Local HTTPS (Vite dev server)
HTTPS_ENABLED=false
HTTPS_CERT_PATH=./certificates/dev/dev-cert.pem
HTTPS_KEY_PATH=./certificates/dev/dev-key.pem
HTTPS_PORT=5174

# Development Proxy
DEV_PROXY_ENABLED=true
DEV_PROXY_TARGET_PORT=3100
DEV_PROXY_TIMEOUT_MS=30000
DEV_PROXY_AUTO_DISCOVER=true
DEV_PROXY_DISCOVERY_PORTS=3100,3000,8080
DEV_PROXY_DISCOVERY_TIMEOUT_MS=10000
DEV_PROXY_PROBE_TIMEOUT_MS=2000

# HTTPS-aware Dev Proxy
DEV_PROXY_HTTPS_ENABLED=false
DEV_PROXY_TARGET_HTTPS_PORT=3101
DEV_PROXY_REJECT_UNAUTHORIZED=false
DEV_PROXY_ALLOWED_HOSTS=localhost,127.0.0.1

# Optional: External API path for experiments (no secrets forwarded)
DEV_PROXY_ASSEMBLYAI_ENABLED=true
DEV_PROXY_ASSEMBLYAI_PATH=/proxy/assemblyai

# Required for server to start (use safer values in production)
ASSEMBLYAI_API_KEY=your_assemblyai_key_here
MONGODB_URI=mongodb://localhost:27017/critgenius-listener
REDIS_URL=redis://localhost:6379
JWT_SECRET=dev-jwt-secret-change-in-production
# ===========================================
# CritGenius Listener Environment Configuration
# ===========================================
# Copy this file to .env and update values for your environment

# Node.js Environment
NODE_ENV=development

# Server Configuration
PORT=3100
CLIENT_PORT=3101
HOST=localhost

# AssemblyAI Configuration
# Get your API key from: https://www.assemblyai.com/
ASSEMBLYAI_API_KEY=your_assemblyai_api_key_here
ASSEMBLYAI_WEBHOOK_URL=http://localhost:3100/api/webhooks/assemblyai

# Database Configuration
# MongoDB connection string
MONGODB_URI=mongodb://localhost:27017/critgenius-listener
MONGODB_DB_NAME=critgenius-listener

# Redis configuration for caching and sessions
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_DB=0

# CritGenius Ecosystem URLs
# Base URL for ecosystem service discovery
CRITGENIUS_ECOSYSTEM_BASE_URL=http://localhost:3000

# Individual CritGenius service URLs
CRITGENIUS_PROMPTER_URL=http://localhost:3001
CRITGENIUS_LLM_URL=http://localhost:3002
CRITGENIUS_PUBLISHER_URL=http://localhost:3003

# CritGenius API Keys (if required for internal services)
CRITGENIUS_ECOSYSTEM_API_KEY=your_ecosystem_api_key_here
CRITGENIUS_SERVICE_TOKEN=your_service_token_here

# Security Configuration
# JWT secret for session management
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=7d

# CORS origins (comma-separated)
CORS_ORIGINS=http://localhost:3101,http://localhost:3000

# Rate limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Audio Processing Configuration
# Maximum audio file size (in bytes)
MAX_AUDIO_FILE_SIZE=52428800
MAX_AUDIO_DURATION=3600

# Supported audio formats (comma-separated)
SUPPORTED_AUDIO_FORMATS=wav,mp3,m4a,flac,ogg

# Session Configuration
# Session timeout in minutes
SESSION_TIMEOUT=60
MAX_CONCURRENT_SESSIONS=10

# Export Configuration
# Directory for temporary export files
EXPORT_TEMP_DIR=./temp-exports
EXPORT_MAX_SIZE=104857600

# Data Retention Configuration
# Automatic cleanup settings
AUTO_CLEANUP_ENABLED=true
CLEANUP_INTERVAL_HOURS=24
DEFAULT_RETENTION_DAYS=30

# Privacy Configuration
# GDPR compliance settings
GDPR_ENABLED=true
DATA_ANONYMIZATION_ENABLED=true
CONSENT_REQUIRED=true

# Logging Configuration
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_PATH=./logs/app.log

# Performance Configuration
# WebSocket configuration
WS_HEARTBEAT_INTERVAL=30000
WS_MAX_CONNECTIONS=100

# Cache configuration
CACHE_TTL=300
CACHE_MAX_SIZE=1000

# Monitoring and Health Checks
# Health check endpoints
HEALTH_CHECK_ENABLED=true
METRICS_ENABLED=true

# External webhook URLs (optional)
SLACK_WEBHOOK_URL=
DISCORD_WEBHOOK_URL=

# Development Configuration (development only)
# Enable debug logging
DEBUG=critgenius:*
DEBUG_SQL=false
DEBUG_REDIS=false

# Hot reload settings
HOT_RELOAD=true
WATCH_FILES=true

# Development Proxy Configuration
# Enables local dev server (Vite) to proxy API/WebSocket + external AssemblyAI to avoid CORS issues
DEV_PROXY_ENABLED=true
DEV_PROXY_TARGET_PORT=3100
DEV_PROXY_ASSEMBLYAI_ENABLED=true
DEV_PROXY_ASSEMBLYAI_PATH=/proxy/assemblyai
DEV_PROXY_TIMEOUT_MS=30000

# Local HTTPS (Optional for secure context - microphone access in some browsers requires https)
HTTPS_ENABLED=false
HTTPS_CERT_PATH=./certificates/dev/dev-cert.pem
HTTPS_KEY_PATH=./certificates/dev/dev-key.pem
HTTPS_PORT=5174

# Testing Configuration (test environment)
# Test database
TEST_MONGODB_URI=mongodb://localhost:27017/critgenius-listener-test
TEST_REDIS_URL=redis://localhost:6379/1

# Mock external services in tests
MOCK_ASSEMBLYAI=false
MOCK_ECOSYSTEM_SERVICES=false

# Production Configuration (production only)
# SSL/TLS settings
SSL_ENABLED=false
SSL_CERT_PATH=
SSL_KEY_PATH=

# Production database with SSL
# MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/critgenius-listener?retryWrites=true&w=majority

# Production Redis with authentication
# REDIS_URL=rediss://username:password@hostname:port

# Content Security Policy
CSP_ENABLED=true
CSP_REPORT_URI=/api/csp-report

# Additional Security Headers
HELMET_ENABLED=true
RATE_LIMIT_ENABLED=true

# ===========================================
# Environment-Specific Notes
# ===========================================
# Development:
# - Use local MongoDB and Redis instances
# - Set DEBUG=critgenius:* for verbose logging
# - Enable hot reload and file watching

# Production:
# - Use managed MongoDB Atlas and Redis Cloud
# - Enable SSL/TLS encryption
# - Set strong JWT secrets and API keys
# - Configure proper CORS origins
# - Enable all security features

# Testing:
# - Use separate test databases
# - Enable service mocking where appropriate
# - Set shorter timeouts for faster test execution
# --- Proxy Registry Managed Section (do not edit manually) ---
# These variables are managed by scripts/generate-proxy-env-example.mjs
# Update the proxy registry in packages/shared if you need changes.
DEV_PROXY_ALLOWED_HOSTS=localhost,127.0.0.1
DEV_PROXY_ASSEMBLYAI_ENABLED=true
DEV_PROXY_ASSEMBLYAI_PATH=/proxy/assemblyai
DEV_PROXY_AUTO_DISCOVER=true
DEV_PROXY_DISCOVERY_PORTS=3100,3000,8080
DEV_PROXY_DISCOVERY_TIMEOUT_MS=10000
DEV_PROXY_ENABLED=true
DEV_PROXY_HTTPS_ENABLED=false
DEV_PROXY_PROBE_TIMEOUT_MS=2000
DEV_PROXY_REJECT_UNAUTHORIZED=false
DEV_PROXY_TARGET_HTTPS_PORT=3101
DEV_PROXY_TARGET_PORT=3100
DEV_PROXY_TIMEOUT_MS=30000
# --- End Managed Section ---


