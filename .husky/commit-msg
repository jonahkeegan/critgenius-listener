#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Validate commit message format using conventional commits
echo "üìù Validating commit message format..."

# Read the commit message
commit_regex='^(feat|fix|docs|style|refactor|test|chore|perf|ci|build|revert)(\(.+\))?!?: .{1,50}'

commit_message=$(cat "$1")

if [[ ! $commit_message =~ $commit_regex ]]; then
  echo "‚ùå Invalid commit message format!"
  echo ""
  echo "Commit message should follow the conventional commits format:"
  echo "<type>[optional scope]: <description>"
  echo ""
  echo "Valid types: feat, fix, docs, style, refactor, test, chore, perf, ci, build, revert"
  echo ""
  echo "Examples:"
  echo "  feat: add audio transcription feature"
  echo "  fix(auth): resolve login issue"
  echo "  docs: update installation guide"
  echo "  refactor!: breaking change to API structure"
  echo ""
  echo "Your commit message: '$commit_message'"
  exit 1
fi

echo "‚úÖ Commit message format is valid!"