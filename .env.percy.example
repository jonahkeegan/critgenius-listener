# Percy Visual Testing Configuration
# ===========================================
# Copy this file to .env.percy and update PERCY_TOKEN with your actual token
# Get your token from: https://percy.io/

# Required Percy Configuration
# Your Percy project token (required for visual testing)
PERCY_TOKEN=your_percy_token_here

# Optional Percy Configuration
# Branch name for visual testing (defaults to current git branch)
PERCY_BRANCH=main

# Percy parallel configuration (for CI/CD parallel testing)
PERCY_PARALLEL_TOTAL=1
PERCY_PARALLEL_NONCE=${CI_BUILD_ID:-local}

# Percy project configuration
# Your Percy project name (auto-detected from repository)
PERCY_PROJECT_NAME=critgenius-listener

# Percy snapshot configuration
# Disable dynamic content that can cause visual drift
PERCY_DOM_SNAPSHOT_DISABLE_ANIMATIONS=true
PERCY_DOM_SNAPSHOT_DISABLE_FAVICONS=true

# Percy environment configuration
# Set to development for local testing
PERCY_ENVIRONMENT=development

# Percy asset discovery configuration
# Timeout for network requests during snapshot discovery
PERCY_DISCOVERY_NETWORK_IDLE_TIMEOUT=750

# Percy JavaScript execution
# Enable JavaScript execution for dynamic content
PERCY_ENABLE_JAVASCRIPT=true

# Percy CSS discovery
# Enable CSS processing for styling validation
PERCY_ENABLE_CSS=true

# Percy asset processing
# Enable asset discovery and processing
PERCY_ENABLE_ASSETS=true

# Percy logging
# Log level for Percy operations (error, warn, info, debug)
PERCY_LOG_LEVEL=info

# Percy local development
# Allow Percy to access local development servers
PERCY_ALLOWED_HOSTNAMES=localhost,127.0.0.1

# Percy CI/CD Integration
# These are typically set by CI/CD platforms
# CI_BUILD_ID - Unique build identifier
# CI_COMMIT_SHA - Git commit SHA
# CI_BRANCH - Git branch name

# Percy snapshot limits
# Maximum number of snapshots per build (plan dependent)
PERCY_SNAPSHOT_LIMIT=100

# Percy comparison configuration
# Minimum visual difference threshold for comparison
PERCY_THRESHOLD=0.1

# Percy responsive configuration
# Percy will automatically test at widths defined in percy.config.yml:
# - Mobile: 375px
# - Tablet: 768px
# - Desktop: 1920px

# ===========================================
# Percy Setup Instructions
# ===========================================
# 1. Create a Percy account at https://percy.io/
# 2. Create a new project for critgenius-listener
# 3. Copy the project token and paste it above as PERCY_TOKEN
# 4. Copy this file to .env.percy and update the token
# 5. Run: PERCY_TOKEN=your_token pnpm --filter @critgenius/client exec -- percy --version
# 6. Run visual tests: pnpm --filter @critgenius/client run test:visual

# ===========================================
# Percy CLI Usage
# ===========================================
# Local testing:
#   PERCY_TOKEN=your_token pnpm --filter @critgenius/client exec -- playwright test tests/visual/
#
# CI/CD usage:
#   Export PERCY_TOKEN as a secret in your CI platform
#   Add to your CI workflow: percy exec -- playwright test tests/visual/

# ===========================================
# Percy Project Setup Commands
# ===========================================
# Verify Percy CLI installation:
#   pnpm exec percy --version
#
# Percy CLI authentication check:
#   PERCY_TOKEN=your_token pnpm exec percy --help
#
# Run visual regression tests:
#   pnpm --filter @critgenius/client run test:visual
#
# Run visual tests in headed mode (for debugging):
#   pnpm --filter @critgenius/client run test:visual:headed
#
# Update visual baselines:
#   pnpm --filter @critgenius/client run test:visual:update
